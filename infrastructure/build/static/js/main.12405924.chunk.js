(this.webpackJsonpapp_101=this.webpackJsonpapp_101||[]).push([[0],{136:function(e,t){},278:function(e,t,n){},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={REGION:"ap-southeast-2",USER_POOL_ID:"ap-southeast-2_4y5PUEuHO",IDENTITY_POOL_ID:"ap-southeast-2:8ca5a2e8-af30-4331-80f5-ae06bd4c625e",APP_CLIENT_ID:"3kuddl04r6vii8ej9tdireh7mn",EMAIL_USER_ID:"user_fFC6R7fs9QAFWZ3jNtSCK",EMAIL_TEMPLATE_ID:"template_qnbr2ql",EMAIL_SERVICE_ID:"service_pkt56l2",BLOGS_PHOTOS_BUCKET:"blogs-photos-02f588656adc"}},688:function(e,t,n){},799:function(e,t){},845:function(e,t,n){"use strict";n.r(t);var r=n(113),a=n.n(r),c=(n(278),n(16)),s=n(70),i=n(71),o=n(117),u=n(264),l=n(263),b=n(4),j=n.n(b),d={API:{endpoints:[{name:"blogs-photos-api",endpoint:"https://55vuvm1sv2.execute-api.ap-southeast-2.amazonaws.com/prod/"}],aws_appsync_graphqlEndpoint:"https://scow7uzczzh7bejwuvwzdpvfwy.appsync-api.ap-southeast-2.amazonaws.com/graphql",aws_appsync_region:"ap-southeast-2",aws_appsync_authenticationType:"API_KEY",aws_appsync_apiKey:"da2-ypnlfnxxwnbdzczo2jya5yl7su"}},p=n(93),O=n(250),h=n(77),f=n.n(h),x=n(50),m=(n(688),n(7)),v=n.n(m),g=n(12),y=n(8),S=n.p+"static/media/react-logo.65ca18b4.png",w=n(251),_=n.n(w),I=n(252),E=n(1),k=function(e,t){var n=t.type,r=t.newState;switch(n){case"REGISTER":case"VERIFY":case"SIGNIN":case"RESET":case"REGISTER_CLICK":case"SET_ERROR":case"CHANGE_CODE":case"CHANGE_EMAIL":case"CHANGE_PASSWORD":case"CHANGE_USER":return Object(c.a)(Object(c.a)({},e),r);default:throw new Error("Unhandled action type ".concat(n))}},N=function(e){var t=Object(b.useReducer)(k,{code:"",email:"",username:"",password:"",error:"",registerMod:!1,verify:!1}),n=Object(y.a)(t,2),r=n[0],a=n[1],c=j.a.useCallback((function(){a({type:"REGISTER",newState:{registerMod:!1,error:"",email:"",password:"",username:"",verify:!0}})}),[]),s=j.a.useCallback((function(){a({type:"SIGNIN",newState:{error:"",email:"",password:"",verify:!1}})}),[]),i=j.a.useCallback((function(){a({type:"VERIFY",newState:{verify:!1}})}),[]),o=j.a.useCallback((function(e){a({type:"CHANGE_USER",newState:{username:e.target.value}})}),[]),u=j.a.useCallback((function(e){a({type:"CHANGE_EMAIL",newState:{email:e.target.value}})}),[]),l=j.a.useCallback((function(e){a({type:"CHANGE_PASSWORD",newState:{password:e.target.value}})}),[]),d=j.a.useCallback((function(e){a({type:"CHANGE_CODE",newState:{code:e.target.value}})}),[]),p=j.a.useCallback((function(e){a({type:"SET_ERROR",newState:{error:e}})}),[]),O=j.a.useCallback((function(){return a({type:"RESET",newState:{email:"",username:"",password:"",error:"",registerMod:!1}})}),[]),h=j.a.useCallback((function(){return a({type:"REGISTER_CLICK",newState:{email:"",username:"",password:"",error:"",registerMod:!0}})}),[]),f=r.code,x=r.email,m=r.username,S=r.password,w=r.error,N=r.registerMod,C=r.verify,A=function(){var t=Object(g.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),!1,t.next=4,e.authService.confirmSignUp(m,f);case 4:!0===t.sent?(i(),e.clearModal()):console.log("Please re-enter code");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(E.jsx)(_.a,{isOpen:!!e.modalOpen,contentLabel:"Login modal",onRequestClose:e.clearModal,closeTimeoutMS:0,ariaHideApp:!1,className:"s7-modal",children:C?Object(E.jsxs)("div",{className:"s7-modal__verify",children:[Object(E.jsx)("h5",{children:"Please check your email and"}),Object(E.jsx)("h5",{children:"enter the 6-digit verification code"}),Object(E.jsx)("h5",{children:"to confirm your account"}),Object(E.jsxs)("form",{onSubmit:A,className:"s7-modal__form",children:[Object(E.jsx)("input",{type:"text","data-testid":"code",name:"code",placeholder:"*   *   *   *   *   *",style:{fontSize:"14px",height:"3rem",width:"9em",textAlign:"center"},onChange:d}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)("button",{className:"main-button",type:"submit",children:"Enter"})]})]}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("h3",{className:"s7-modal__title",children:[N?"Registration details":"Sign in details"," "]}),Object(E.jsxs)("form",{onSubmit:function(t){t.preventDefault();N&&!m||!S||!x?p("All fields are required"):I.validate(x)?N&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*_])[a-zA-Z0-9!@#$%^&*_]{8,16}$/.test(S)?p("Password policy requires at least :\n      \n      8-16 characters\n      One number\n      One uppercase letter\n      One lowercase letter\n      One special character"):(e.onSubmission({username:m,email:x,password:S}),N?c():(s(),e.clearModal())):p("Email must be in a valid format")},children:[N&&Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("br",{}),Object(E.jsx)("label",{htmlFor:"userName",children:"Username:"}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"text","data-testid":"username",name:"username",placeholder:"username",style:{fontSize:"12px",height:"1.5rem",width:"22rem"},onChange:o}),Object(E.jsx)("br",{})]}),Object(E.jsx)("br",{}),Object(E.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"text","data-testid":"useremail",name:"useremail",placeholder:"email",style:{fontSize:"12px",height:"1.5rem",width:"22rem"},onChange:u}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"text","data-testid":"password",name:"password",placeholder:"password",style:{fontSize:"12px",height:"1.5rem",width:"22rem"},onChange:l}),w&&Object(E.jsx)("div",{className:"s7-modal__error","data-testid":"modal-error",children:Object(E.jsx)("h5",{children:w})}),Object(E.jsxs)("div",{className:"s7-modal__spacer",children:[Object(E.jsx)("button",{className:"main-button",onClick:function(){O(),e.clearModal()},children:"Cancel"}),Object(E.jsx)("button",{className:"main-button",type:"submit",children:"Enter"})]})]}),!N&&Object(E.jsxs)("div",{children:[Object(E.jsx)("h5",{children:"If you are not a member please register"}),Object(E.jsx)("button",{className:"main-button",onClick:h,children:"Register"})]})]})})},C=n(32),A=function(e){var t=e.authService,n=e.user,r=e.setUser,a=Object(b.useState)(!1),c=Object(y.a)(a,2),s=c[0],i=c[1],o=Object(b.useState)(!1),u=Object(y.a)(o,2),l=u[0],j=u[1],d=function(){document.body.classList.remove("nav-is-active"),j(!1)},p=function(){var e=Object(g.a)(v.a.mark((function e(n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.username){e.next=7;break}return e.next=3,t.login(n.email,n.password);case 3:a=e.sent,r(a),e.next=9;break;case 7:return e.next=9,t.signUp(n.username,n.password,n.email);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(E.jsxs)("header",{className:"s6-hc",children:[Object(E.jsxs)("div",{className:"s6-hc__title",children:[Object(E.jsx)("span",{children:Object(E.jsxs)("h1",{children:[Object(E.jsx)("img",{src:S,className:"s6-hc__logo",alt:"React logo"}),"React.JS blog template"]})}),Object(E.jsx)("button",{className:"s6-hc__toggle",onClick:l?d:function(){document.body.classList.add("nav-is-active"),j(!0)},children:Object(E.jsx)("span",{className:"hamburger","data-testid":"hamburger",children:Object(E.jsx)("span",{className:"hamburger-inner"})})})]}),Object(E.jsx)("div",{className:"s6-hc__nc",children:Object(E.jsxs)("ul",{children:[Object(E.jsx)("li",{children:Object(E.jsx)(C.a,{exact:!0,onClick:d,activeClassName:"s6-hc__link--active",to:"/",tabIndex:1,children:"Home"})}),Object(E.jsx)("li",{children:Object(E.jsx)(C.a,{onClick:d,activeClassName:"s6-hc__link--active",to:"/dashboard",tabIndex:2,children:"Dashboard"})}),Object(E.jsx)("li",{children:Object(E.jsx)(C.a,{onClick:d,activeClassName:"s6-hc__link--active",to:"/createblog",tabIndex:3,children:"Create blog"})}),Object(E.jsx)("li",{children:Object(E.jsx)(C.a,{onClick:d,activeClassName:"s6-hc__link--active",to:"/myblogs",tabIndex:4,children:"My blogs"})}),Object(E.jsx)("li",{children:Object(E.jsxs)("div",{className:"s6-hc__signin",children:[Object(E.jsx)("h3",{children:n?"Signed in as : ".concat(n.username):""}),Object(E.jsx)("button",{className:"main-button",onClick:function(){n?r(void 0):(i(!0),document.body.classList.remove("nav-is-active"))},tabIndex:5,children:n?"Sign Out":"Sign In"})]})})]})}),Object(E.jsx)(N,{modalOpen:s,clearModal:function(){i(!1)},onSubmission:p,authService:t})]})};A.defaultProps={user:void 0};var T=A,R=n(74),U=n(41),P=function(e){var t,n,r=e.blog,a=e.dataService,c=Object(b.useState)(""),s=Object(y.a)(c,2),i=s[0],o=s[1],u=Object(b.useState)(U.EditorState.createEmpty()),l=Object(y.a)(u,2),d=l[0],p=l[1];return Object(b.useEffect)((function(){if(r.content){var e=Object(U.convertFromRaw)(JSON.parse(r.content)),t=U.EditorState.createWithContent(e);p(t)}var n=function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getBlogFile(t);case 2:n=e.sent,"",r=btoa(n.Body.reduce((function(e,t){return e+String.fromCharCode(t)}),"")),c="data:image/jpeg;base64,".concat(r),o(c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.blogPhotoId&&n(r.blogPhotoId)}),[a,r]),Object(E.jsxs)(j.a.Fragment,{children:[Object(E.jsx)(C.a,{style:{textDecoration:"none"},to:"/blog/".concat(r.id),children:Object(E.jsxs)("div",{className:"section-1-bi",children:[Object(E.jsxs)("div",{className:"s1-bi__upper",children:[Object(E.jsx)("h1",{children:r.title}),Object(E.jsx)("span",{children:r.createdAt})]}),Object(E.jsx)("div",{className:"s1-bi__inner",children:Object(E.jsx)(R.Editor,{toolbarHidden:!0,editorState:d,wrapperClassName:"s1-bi__entry-wrapper s1-bi__display-wrapper",readOnly:!0})}),i&&Object(E.jsx)("div",{className:"s1-bi__image center",children:Object(E.jsx)("img",{src:i,alt:"blog_image"})}),Object(E.jsxs)("div",{className:"s1-bi__lower",children:[Object(E.jsxs)("p",{children:["Written by: ",null===(t=r.owner)||void 0===t?void 0:t.username]}),Object(E.jsxs)("p",{children:["Replies: ",null===(n=r.entries)||void 0===n?void 0:n.length]})]})]})}),Object(E.jsx)(C.a,{to:{pathname:"/createentry",state:{blog_id:r.id}},children:Object(E.jsx)("button",{className:"blog-button",children:"Reply"})})]})},B=function(e){var t,n=Object(b.useState)(""),r=Object(y.a)(n,2),a=r[0],c=r[1],s=Object(b.useState)(U.EditorState.createEmpty()),i=Object(y.a)(s,2),o=i[0],u=i[1],l=e.entry,j=e.dataService;return Object(b.useEffect)((function(){if(l.content){var e=Object(U.convertFromRaw)(JSON.parse(l.content)),t=U.EditorState.createWithContent(e);u(t)}var n=function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getBlogFile(t);case 2:n=e.sent,"",r=btoa(n.Body.reduce((function(e,t){return e+String.fromCharCode(t)}),"")),a="data:image/jpeg;base64,".concat(r),c(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();l.entryPhotoId&&n(l.entryPhotoId)}),[j,l]),Object(E.jsxs)("div",{className:"section-1-bi",children:[Object(E.jsxs)("div",{className:"s1-bi__upper",children:[Object(E.jsx)("h1",{children:l.title}),Object(E.jsx)("span",{children:l.createdAt})]}),Object(E.jsx)("div",{className:"s1-bi__inner",children:Object(E.jsx)(R.Editor,{toolbarHidden:!0,editorState:o,wrapperClassName:"s1-bi__entry-wrapper s1-bi__display-wrapper",readOnly:!0})}),a&&Object(E.jsx)("div",{className:"s1-bi__image center",children:Object(E.jsx)("img",{src:a,alt:"entry_image"})}),Object(E.jsx)("div",{className:"s1-bi__lower",children:Object(E.jsxs)("p",{children:["Written by: ",null===(t=l.owner)||void 0===t?void 0:t.username]})})]})},L=function(e){var t,n=e.dataService,r=e.match,a=Object(b.useState)({id:"",createdAt:"",title:"",content:"",user:"",blogPhotoId:"",entries:[]}),s=Object(y.a)(a,2),i=s[0],o=s[1];return Object(b.useEffect)((function(){(function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadBlog(r.params.id);case 2:t=e.sent,o(Object(c.a)({},t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[n,r]),Object(E.jsxs)("div",{className:"s3-bc",children:[Object(E.jsx)(P,{blog:Object(c.a)({},i),dataService:n},null===i||void 0===i?void 0:i.id),Object(E.jsx)("h3",{children:"Entries:"}),null===i||void 0===i||null===(t=i.entries)||void 0===t?void 0:t.map((function(e){return Object(E.jsx)(B,{entry:Object(c.a)({},e),dataService:n},e.id)}))]})},F=n.p+"static/media/image_box.cd732acf.png",D=(n(798),function(e){var t=e.userId,n=e.dataService,r=e.onSubmission,a=Object(b.useState)(""),c=Object(y.a)(a,2),s=c[0],i=c[1],o=Object(b.useState)(""),u=Object(y.a)(o,2),l=u[0],j=u[1],d=Object(b.useState)(""),p=Object(y.a)(d,2),O=p[0],h=p[1],f=Object(b.useState)(U.EditorState.createEmpty()),x=Object(y.a)(f,2),m=x[0],S=x[1],w=function(){var e=Object(g.a)(v.a.mark((function e(a){var c,i,o,u,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),c=m.getCurrentContent(),i=JSON.stringify(Object(U.convertToRaw)(c)),s&&i){e.next=7;break}j("Both title and content are required"),e.next=19;break;case 7:if(!t){e.next=18;break}if(j(""),o=document.getElementById("file-upload"),u=o.files[0],l="",!u){e.next=15;break}return e.next=15,n.uploadBlogFile(u).then((function(e){return l=e})).catch((function(e){return console.log(e)}));case 15:r(s,i,l),e.next=19;break;case 18:j("Please sign in");case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.useEffect)((function(){var e=document.getElementById("file-upload"),t=function(e){var t=e.target.files[0],n=[];n.push(t);var r=URL.createObjectURL(new Blob(n,{type:"image/*"}));h(r)};return e.addEventListener("change",t),function(){return null===e||void 0===e?void 0:e.removeEventListener("change",t)}}),[O]),Object(E.jsxs)("div",{className:"s4-cc__ec",children:[Object(E.jsxs)("form",{onSubmit:w,children:[Object(E.jsx)("label",{htmlFor:"title",children:"Title:"}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"text",id:"title",name:"title",placeholder:"...",onChange:function(e){return i(e.target.value)}}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)(R.Editor,{editorState:m,wrapperClassName:"s1-bi__entry-wrapper",onEditorStateChange:function(e){return S(e)}}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)("label",{htmlFor:"file-upload",children:"Upload image:"}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"file",id:"file-upload",name:"file",accept:"image/*"}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{className:"button",type:"submit",value:"Save"})]}),l&&Object(E.jsxs)("p",{children:["Error : ",l]}),Object(E.jsx)("br",{}),Object(E.jsx)("button",{onClick:function(){return h("")},children:"Clear image"}),Object(E.jsx)("br",{}),O?Object(E.jsx)("img",{src:O,alt:"imageRetrieved",style:{height:"50%",width:"50%",marginTop:"20px"}}):Object(E.jsx)("img",{src:F,alt:"blog",style:{height:"10rem",width:"13rem",marginTop:"40px"}})]})}),M=n(17),q=function(e){var t=e.currentUser,n=e.dataService,r=Object(b.useState)(""),a=Object(y.a)(r,2),c=a[0],s=a[1],i=Object(b.useState)(!1),o=Object(y.a)(i,2),u=o[0],l=o[1];return Object(b.useEffect)((function(){if(t){new Promise((function(e){t.user.getUserAttributes((function(t,n){if(t)return alert(t),"";n&&e(n[0].Value)}))})).then((function(e){s(e)}))}}),[t]),Object(E.jsxs)("div",{className:"s4-cc",children:[Object(E.jsx)("h1",{children:"Create blog"}),Object(E.jsx)(D,{onSubmission:function(e,t,r){n.createBlog({title:e,content:t,blogPhotoId:r,user:c}).then((function(e){!0===e&&l(!0)})).catch((function(e){return console.log(e)}))},dataService:n,userId:c}),u&&Object(E.jsx)(M.a,{to:"/dashboard"})]})},G=n(76),z=function(e){var t=e.text,n=e.search,r=e.setText,a=e.setSearch;return Object(E.jsxs)("div",{className:"s2-lf-wrapper",children:[Object(E.jsx)("h3",{className:"s2-lf__title",children:"Search by:"}),Object(E.jsxs)("div",{className:"s2-lf__container",children:[Object(E.jsx)("input",{className:"s2-lf__bar",type:"text",value:t,onChange:function(e){return r(e.target.value)}}),Object(E.jsx)("span",{children:Object(E.jsxs)("select",{className:"s2-lf__pulldown",value:n,onChange:function(e){return a(e.target.value)},children:[Object(E.jsx)("option",{value:"Title",children:"Title"}),Object(E.jsx)("option",{value:"Content",children:"Content"})]})})]})]})},$=function(){return Object(E.jsx)("div",{className:"lds-container",children:Object(E.jsxs)("div",{className:"lds-default",children:[Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{})]})})},H=function(e,t){for(var n=5*t,r=[],a=n-5;a<n;a++)e[a]&&r.push(e[a]);return r},W=function(e,t,n){return t&&(e="Title"===n?e.filter((function(e){return e.title.includes(t)})):e.filter((function(e){return e.content.includes(t)}))),e},K=function(e){var t,n=e.dataService,r=Object(b.useState)(""),a=Object(y.a)(r,2),s=a[0],i=a[1],o=Object(b.useState)("Title"),u=Object(y.a)(o,2),l=u[0],j=u[1],d=Object(b.useState)(1),p=Object(y.a)(d,2),O=p[0],h=p[1],f=Object(b.useState)([]),x=Object(y.a)(f,2),m=x[0],v=x[1],g=Object(b.useState)(!0),S=Object(y.a)(g,2),w=S[0],_=S[1];if(Object(b.useEffect)((function(){n.getBlogs().then((function(e){v(e),_(!1)})).catch((function(e){return console.log(e)}))}),[n]),w)return Object(E.jsx)($,{});var I=W(m,s,l),k=I.length;return I=H(I,O),Object(E.jsxs)("div",{children:[Object(E.jsx)(z,{text:s,search:l,setText:function(e){i(e),h(1)},setSearch:function(e){return j(e)}}),Object(E.jsx)("div",{className:"s3-bc",children:null===(t=I)||void 0===t?void 0:t.map((function(e){return Object(E.jsx)(P,{blog:Object(c.a)({},e),dataService:n},e.id)}))}),Object(E.jsx)("div",{className:"page-numbers",children:Object(G.a)(Array(Math.ceil(k/5))).map((function(e,t){return Object(E.jsx)("button",{className:"page-button",onClick:function(){return h(t+1)},children:t+1},t)}))})]})},J=function(){return Object(E.jsx)("h1",{style:{fontSize:"1em",color:"white",padding:"4em",marginTop:"0"},children:"Welcome to the Home page."})},V=n(33),Y=Object(V.a)(),Z=n(95);p.default.configure({Auth:{mandatorySignIn:!1,region:x.a.REGION,identityPoolId:x.a.IDENTITY_POOL_ID,userPoolId:x.a.USER_POOL_ID,userPoolWebClientId:x.a.APP_CLIENT_ID,authenticationFlowType:"USER_SRP_AUTH"}});var Q,X,ee,te,ne,re,ae,ce,se,ie=function(){function e(){Object(s.a)(this,e)}return Object(i.a)(e,[{key:"login",value:function(){var e=Object(g.a)(v.a.mark((function e(t,n){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.a.signIn(t,n);case 3:return r=e.sent,e.abrupt("return",{username:r.getUsername(),user:r});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,Z.a.userAttributes(t.user);case 3:return r=e.sent,n.push.apply(n,Object(G.a)(r)),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"signUp",value:function(){var e=Object(g.a)(v.a.mark((function e(t,n,r){var a,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.a.signUp({username:t,password:n,attributes:{email:r}});case 3:return a=e.sent,c=a.user,e.abrupt("return",{username:c.getUsername(),user:c});case 8:return e.prev=8,e.t0=e.catch(0),console.log("error signing up:",e.t0),e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"confirmSignUp",value:function(){var e=Object(g.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.a.confirmSignUp(t,n);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),console.log("Error confirming sign up",e.t0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.a.signOut();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error signing out: ",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),oe=n(52),ue=n(53),le=Object(ue.a)(Q||(Q=Object(oe.a)(["\n  mutation ($createUserInput: NewUserInput!) {\n    createUser(input: $createUserInput) {\n      id\n      username\n      email\n      password\n      createdAt\n    }\n  }\n"]))),be=(Object(ue.a)(X||(X=Object(oe.a)(["\n  mutation ($loginInput: AuthInput!) {\n    login(input: $loginInput) {\n      id\n      username\n      email\n      password\n      tokens\n    }\n  }\n"]))),Object(ue.a)(ee||(ee=Object(oe.a)(["\n  query Query($userId: ID!) {\n    user(id: $userId) {\n      id\n      username\n    }\n  }\n"]))),Object(ue.a)(te||(te=Object(oe.a)(["\n  mutation ($createBlogInput: NewBlogInput!) {\n    createBlog(input: $createBlogInput) {\n      id\n      title\n      content\n      createdAt\n    }\n  }\n"])))),je=Object(ue.a)(ne||(ne=Object(oe.a)(["\n  mutation ($createEntryInput: NewEntryInput!) {\n    createEntry(input: $createEntryInput) {\n      id\n      title\n      content\n      createdAt\n      blog_id\n      user\n    }\n  }\n"]))),de=Object(ue.a)(re||(re=Object(oe.a)(["\n  query Query($userId: ID!) {\n    blogsByUser(id: $userId) {\n      id\n      title\n      content\n      createdAt\n      blogPhotoId\n      entries {\n        id\n      }\n      owner {\n        username\n      }\n    }\n  }\n"]))),pe=Object(ue.a)(ae||(ae=Object(oe.a)(["\n  mutation ($deleteBlogInput: deleteBlogType!) {\n    deleteBlog(input:$deleteBlogInput) {\n      id\n    }\n  }\n"]))),Oe=Object(ue.a)(ce||(ce=Object(oe.a)(["\n  query {\n    blogs {\n      id\n      title\n      content\n      createdAt\n      blogPhotoId\n      entries {\n        id\n      }\n      owner {\n        username\n      }\n    }\n  }\n"]))),he=Object(ue.a)(se||(se=Object(oe.a)(["\n  query Query($blogId: ID!) {\n    blog(id: $blogId) {\n      id\n      title\n      content\n      createdAt\n      blogPhotoId\n      entries {\n        id\n        title\n        content\n        createdAt\n        entryPhotoId\n        owner {\n          username\n        }\n      }\n      owner {\n        username\n      }\n    }\n  }\n"]))),fe=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))};var xe=function(){function e(){Object(s.a)(this,e)}return Object(i.a)(e,[{key:"getAuthToken",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.a.currentSession();case 2:return e.abrupt("return",e.sent.getIdToken().getJwtToken());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getBlogs",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.graphql({query:Oe});case 2:return t=e.sent,e.abrupt("return",t.data.blogs);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getBlogsByUser",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.graphql({query:de,variables:{userId:t}});case 3:return n=e.sent,console.log(n),e.abrupt("return",n.data.blogsByUser);case 8:return e.prev=8,e.t0=e.catch(0),console.log("From dataservice ",e.t0),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadBlog",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.graphql({query:he,variables:{blogId:t}});case 2:return n=e.sent,e.abrupt("return",n.data.blog);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBlogFile",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new h.S3({region:x.a.REGION}),a={Bucket:x.a.BLOGS_PHOTOS_BUCKET,Key:"blogs/"+t},e.prev=2,e.next=5,r.getObject(a).promise();case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("500 - ",e.t0);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadBlogFile",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r,a,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAuthToken();case 3:n=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:return e.next=11,fe(t);case 11:return r=e.sent,a=Math.random().toString(36).slice(2),e.prev=13,e.next=16,O.a.post("blogs-photos-api","blogs/?filename=".concat(a),{body:r,headers:{Authorization:"Bearer ".concat(n),"Content-type":"image/jpeg"}});case 16:c=e.sent,e.next=23;break;case 19:return e.prev=19,e.t1=e.catch(13),console.log(e.t1),e.abrupt("return","");case 23:return console.log("From REST : ",c),e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this,[[0,6],[13,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createBlog",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAuthToken();case 3:return r=e.sent,console.log("Auth token: ",r),e.next=7,O.a.graphql({query:be,variables:{createBlogInput:Object(c.a)({},t)},authMode:"AMAZON_COGNITO_USER_POOLS",authToken:r});case 7:n=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 14:return console.log("Blog created succesfully ",n),e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBlog",value:function(){var e=Object(g.a)(v.a.mark((function e(t,n){var r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAuthToken();case 3:return r=e.sent,e.next=6,O.a.graphql({query:pe,variables:{deleteBlogInput:{id:t,user:n}},authMode:"AMAZON_COGNITO_USER_POOLS",authToken:r});case 6:return a=e.sent,console.log("From dataService result: ",a),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(0),console.log("From dataservice error: ",e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEntry",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAuthToken();case 3:return r=e.sent,e.next=6,O.a.graphql({query:je,variables:{createEntryInput:Object(c.a)({},t)},authMode:"AMAZON_COGNITO_USER_POOLS",authToken:r});case 6:n=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 13:return console.log("Entry created succesfully ",n),e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createUser",value:function(){var e=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.graphql({query:le,variables:{createUserInput:Object(c.a)({},t)}});case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),console.log("From dataservice ",e.t0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),me=function(e){var t=e.currentUser,n=e.dataService,r=Object(M.g)().state,a=Object(b.useState)(""),c=Object(y.a)(a,2),s=c[0],i=c[1],o=Object(b.useState)(!1),u=Object(y.a)(o,2),l=u[0],j=u[1];return Object(b.useEffect)((function(){if(t){new Promise((function(e){t.user.getUserAttributes((function(t,n){if(t)return alert(t),"";n&&e(n[0].Value)}))})).then((function(e){i(e)}))}}),[t]),Object(E.jsxs)("div",{className:"s4-cc",children:[Object(E.jsx)("h1",{children:"Create entry"}),Object(E.jsx)(D,{onSubmission:function(e,t,a){n.createEntry({title:e,content:t,user:s,blog_id:r.blog_id,entryPhotoId:a}).then((function(e){!0===e&&j(!0)})).catch((function(){return console.log("Error creating entry")}))},dataService:n,userId:s}),l&&Object(E.jsx)(M.a,{to:"/dashboard"})]})},ve=n.p+"static/media/facebook_icon.0121b0e0.svg",ge=n.p+"static/media/portfolio-icon.e18b049c.png",ye=n.p+"static/media/github-logo-cat.c76697ae.png",Se=function(){return Object(E.jsx)("div",{className:"s5-fc",children:Object(E.jsxs)("ul",{children:[Object(E.jsx)("li",{children:"Follow me on: "}),Object(E.jsx)("li",{children:Object(E.jsxs)("a",{href:"https://www.facebook.com",children:[Object(E.jsx)("p",{children:"Facebook"}),Object(E.jsx)("span",{children:Object(E.jsx)("img",{src:ve,alt:"facebook",style:{height:"3rem",width:"3rem"}})})]})}),Object(E.jsx)("li",{children:Object(E.jsxs)("a",{href:"http://dimo-portfolio.net",children:[Object(E.jsx)("p",{children:"Portfolio"}),Object(E.jsx)("span",{children:Object(E.jsx)("img",{src:ge,alt:"portfolio",style:{height:"3rem",width:"3rem",marginTop:"1rem"}})})]})}),Object(E.jsx)("li",{children:Object(E.jsxs)("a",{href:"http://www.github.com/dimo121",children:[Object(E.jsx)("p",{children:"Github"}),Object(E.jsx)("span",{children:Object(E.jsx)("img",{src:ye,alt:"Github",style:{height:"4rem",width:"5.5rem"}})})]})}),Object(E.jsx)("li",{children:Object(E.jsx)(C.a,{to:"/contactus",children:"Contact Us"})}),Object(E.jsx)("li",{children:Object(E.jsx)(C.a,{to:"/partners",children:"Partners"})})]})})},we=function(e){var t=e.user,n=e.dataService,r=Object(b.useState)([]),a=Object(y.a)(r,2),s=a[0],i=a[1],o=Object(b.useState)(!0),u=Object(y.a)(o,2),l=u[0],j=u[1],d=Object(b.useState)(1),p=Object(y.a)(d,2),O=p[0],h=p[1],f=Object(b.useState)(""),x=Object(y.a)(f,2),m=x[0],S=x[1],w=Object(b.useState)("Title"),_=Object(y.a)(w,2),I=_[0],k=_[1],N=Object(b.useState)(""),C=Object(y.a)(N,2),A=C[0],T=C[1],R=Object(b.useState)(!1),U=Object(y.a)(R,2),B=U[0],L=U[1];if(Object(b.useEffect)((function(){(function(){var e=Object(g.a)(v.a.mark((function e(){var r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,n){t?t.user.getUserAttributes((function(t,n){if(t)return alert(t),"";n&&e(n[0].Value)})):n("Error retrieving user id")}));case 3:r=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return");case 10:return e.next=12,n.getBlogsByUser(r);case 12:a=e.sent,i(a),j(!1),T(r);case 16:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}})()()}),[t,n]),!t)return Object(E.jsx)("h1",{style:{fontSize:"1em",color:"white",padding:"4em",marginTop:"0"},children:"Login to see user specific blogs"});if(l)return Object(E.jsx)($,{});var F=W(s,m,I),D=F.length;return F=H(F,O),Object(E.jsxs)("div",{children:[Object(E.jsx)(z,{text:m,search:I,setText:function(e){S(e),h(1)},setSearch:function(e){return k(e)}}),Object(E.jsx)("div",{className:"s3-bc",children:F.map((function(e,t){return Object(E.jsxs)("div",{children:[Object(E.jsx)(P,{blog:Object(c.a)({},e),dataService:n}),Object(E.jsx)("button",{className:"blog-button delete-button",onClick:Object(g.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.deleteBlog(e.id,A);case 2:t.sent&&L(!0);case 4:case"end":return t.stop()}}),t)}))),children:"Delete"})]},t)}))}),Object(E.jsx)("div",{className:"page-numbers",children:Object(G.a)(Array(Math.ceil(D/5))).map((function(e,t){return Object(E.jsx)("button",{className:"page-button",onClick:function(){return h(t+1)},children:t+1},t)}))}),B&&Object(E.jsx)(M.a,{to:"/dashboard"})]})},_e=function(){return Object(b.useEffect)((function(){var e=Y.listen((function(){window.scrollTo(0,0)}));return function(){e()}}),[]),null},Ie=Object(b.lazy)((function(){return n.e(3).then(n.bind(null,872))})),Ee=Object(b.lazy)((function(){return n.e(4).then(n.bind(null,873))}));p.default.configure(d),O.a.configure(d),f.a.config.region="ap-southeast-2",f.a.config.credentials=new f.a.CognitoIdentityCredentials({IdentityPoolId:x.a.IDENTITY_POOL_ID});var ke=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).authService=new ie,r.dataService=new xe,r.state={user:void 0},r.setUser=r.setUser.bind(Object(o.a)(r)),r}return Object(i.a)(n,[{key:"setUser",value:function(e){this.setState({user:e}),console.log("Logged in user is: ",null===e||void 0===e?void 0:e.username)}},{key:"render",value:function(){var e=this;return Object(E.jsx)("div",{className:"main-container",children:Object(E.jsx)(M.c,{history:Y,children:Object(E.jsxs)("div",{children:[Object(E.jsx)(_e,{}),Object(E.jsx)(T,{user:this.state.user,setUser:this.setUser,authService:this.authService}),Object(E.jsx)("div",{className:"page-container",children:Object(E.jsxs)(M.d,{children:[Object(E.jsx)(M.b,{exact:!0,path:"/",component:J}),Object(E.jsx)(M.b,{exact:!0,path:"/dashboard",render:function(t){return Object(E.jsx)(K,Object(c.a)(Object(c.a)({},t),{},{dataService:e.dataService}))}}),Object(E.jsx)(M.b,{exact:!0,path:"/createblog",render:function(t){return Object(E.jsx)(q,Object(c.a)(Object(c.a)({},t),{},{dataService:e.dataService,currentUser:e.state.user}))}}),Object(E.jsx)(M.b,{exact:!0,path:"/createentry",render:function(t){return Object(E.jsx)(me,Object(c.a)(Object(c.a)({},t),{},{dataService:e.dataService,currentUser:e.state.user}))}}),Object(E.jsx)(M.b,{exact:!0,path:"/myblogs",render:function(t){return Object(E.jsx)(we,Object(c.a)(Object(c.a)({},t),{},{dataService:e.dataService,user:e.state.user}))}}),Object(E.jsx)(M.b,{exact:!0,path:"/blog/:id",render:function(t){return Object(E.jsx)(L,Object(c.a)(Object(c.a)({},t),{},{dataService:e.dataService}))}}),Object(E.jsx)(M.b,{exact:!0,path:"/partners",render:function(){return Object(E.jsx)(b.Suspense,{fallback:Object(E.jsx)("h1",{children:"Loading..."}),children:Object(E.jsx)(Ee,{})})}}),Object(E.jsx)(M.b,{exact:!0,path:"/contactus",render:function(){return Object(E.jsx)(b.Suspense,{fallback:Object(E.jsx)("h1",{children:"Loading..."}),children:Object(E.jsx)(Ie,{})})}})]})}),Object(E.jsx)(Se,{})]})})})}}]),n}(j.a.Component);a.a.render(Object(E.jsx)(ke,{}),document.getElementById("root"))}},[[845,1,2]]]);
//# sourceMappingURL=main.12405924.chunk.js.map